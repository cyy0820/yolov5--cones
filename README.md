# ðŸš€ YOLOv5 è‡ªå®šä¹‰ç›®æ ‡æ£€æµ‹æ¨¡æ¿


è¿™æ˜¯ä¸€ä¸ªåŸºäºŽå®˜æ–¹ **YOLOv5** çš„å¢žå¼ºåž‹é¡¹ç›®æ¨¡æ¿ï¼Œæ—¨åœ¨å¸®åŠ©æ‚¨ä»¥å‰æ‰€æœªæœ‰çš„é€Ÿåº¦æž„å»ºã€è®­ç»ƒå’Œéƒ¨ç½²é«˜æ€§èƒ½çš„è‡ªå®šä¹‰ç›®æ ‡æ£€æµ‹æ¨¡åž‹ã€‚æ— è®ºæ‚¨æ˜¯ä»Žäº‹å·¥ä¸šè´¨æ£€ã€å®‰é˜²ç›‘æŽ§ã€è‡ªåŠ¨é©¾é©¶è¿˜æ˜¯åˆ›æ„åº”ç”¨ï¼Œæ­¤æ¨¡æ¿éƒ½èƒ½æä¾›ä¸€ä¸ªåšå®žä¸”é«˜æ•ˆçš„èµ·ç‚¹ã€‚

![ç›®æ ‡æ£€æµ‹ç¤ºä¾‹](https://raw.githubusercontent.com/ultralytics/yolov5/master/data/images/zidane.jpg)

## âœ¨ é¡¹ç›®äº®ç‚¹

- ðŸ”§ **ä¸€é”®å¯åŠ¨**: æä¾›äº†é¢„è®¾çš„ç›®å½•ç»“æž„å’Œè„šæœ¬ï¼ŒçœŸæ­£å®žçŽ°å¼€ç®±å³ç”¨ã€‚
- ðŸ§  **è¿ç§»å­¦ä¹ **: æ— ç¼åŠ è½½å®˜æ–¹é¢„è®­ç»ƒæƒé‡ï¼Œæžå¤§ç¼©çŸ­æ‚¨çš„è®­ç»ƒæ—¶é—´ã€‚
- ðŸ“Š **å…¨é¢è¯„ä¼°**: å†…ç½® mAP è®¡ç®—ã€PR æ›²çº¿ã€æ··æ·†çŸ©é˜µç­‰å¤šç§è¯„ä¼°å·¥å…·ï¼Œå…¨æ–¹ä½æŽŒæ¡æ¨¡åž‹æ€§èƒ½ã€‚
- ðŸ“± **å¤šå¹³å°éƒ¨ç½²**: æ”¯æŒå¯¹å›¾åƒã€è§†é¢‘ã€ç½‘ç»œæ‘„åƒå¤´è¿›è¡ŒæŽ¨ç†ï¼Œå¹¶å¯è½»æ¾å¯¼å‡ºä¸º ONNXã€TensorRT ç­‰æ ¼å¼ã€‚
- âš¡ **æ€§èƒ½ä¼˜åŒ–**: é›†æˆäº†æ¨¡åž‹é‡åŒ–ã€TensorRT åŠ é€Ÿç­‰ä¸šç•Œé¢†å…ˆçš„ä¼˜åŒ–æ–¹æ¡ˆã€‚
- ðŸ”„ **æŒç»­é›†æˆ**: åŒ…å« GitHub Actions ç¤ºä¾‹ï¼ŒåŠ©æ‚¨è½»æ¾å®žçŽ°è‡ªåŠ¨åŒ–è®­ç»ƒä¸Žæµ‹è¯•ã€‚

## ðŸ“‹ çŽ¯å¢ƒè¦æ±‚

åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„çŽ¯å¢ƒä¸­å·²å®‰è£…ä»¥ä¸‹è½¯ä»¶ï¼š
- **Python**: 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Git**: ç”¨äºŽç‰ˆæœ¬æŽ§åˆ¶å’Œå…‹éš†ä»“åº“
- **PyTorch**: 1.7 æˆ–æ›´é«˜ç‰ˆæœ¬
- å¼ºçƒˆå»ºè®®ä½¿ç”¨é…å¤‡ **NVIDIA GPU** çš„çŽ¯å¢ƒä»¥èŽ·å¾—æœ€ä½³è®­ç»ƒæ€§èƒ½ã€‚

## ðŸ å¿«é€Ÿå¼€å§‹

#### 1. å…‹éš†é¡¹ç›®ä»“åº“

```bash
# å…‹éš†ä¸»é¡¹ç›®
git clone https://github.com/[Your-GitHub-Username]/my-yolov5-project.git
cd my-yolov5-project
```

#### 2. åˆå§‹åŒ– YOLOv5 å­æ¨¡å—

æˆ‘ä»¬ä½¿ç”¨ `git submodule` æ¥å¼•ç”¨å®˜æ–¹ YOLOv5 ä»“åº“ï¼Œç¡®ä¿ä»£ç åŒæ­¥å’Œçº¯å‡€ã€‚

```bash
# åˆå§‹åŒ–å¹¶æ‹‰å–å­æ¨¡å—ä»£ç 
git submodule update --init --recursive
```

#### 3. åˆ›å»ºè™šæ‹ŸçŽ¯å¢ƒå¹¶å®‰è£…ä¾èµ–

> **æœ€ä½³å®žè·µ**: å§‹ç»ˆä½¿ç”¨è™šæ‹ŸçŽ¯å¢ƒï¼ˆå¦‚ venv æˆ– condaï¼‰æ¥éš”ç¦»é¡¹ç›®ä¾èµ–ã€‚

```bash
# åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹ŸçŽ¯å¢ƒ (Linux/macOS)
python -m venv .venv
source .venv/bin/activate

# (Windows ä½¿ç”¨)
# .venv\Scripts\activate

# å®‰è£…æ‰€æœ‰å¿…éœ€çš„ä¾èµ–åŒ…
pip install -r yolov5/requirements.txt
```

#### 4. éªŒè¯å®‰è£…

è¿è¡Œä¸€ä¸ªç®€å•çš„æ£€æµ‹ä»»åŠ¡æ¥éªŒè¯ YOLOv5 æ˜¯å¦å·²æ­£ç¡®å®‰è£…ã€‚

```bash
python yolov5/detect.py --weights yolov5s.pt --source yolov5/data/images/bus.jpg
```
> **é¢„æœŸç»“æžœ**: ç¨‹åºä¼šè‡ªåŠ¨ä¸‹è½½ `yolov5s.pt` æƒé‡ï¼Œå¹¶å¯¹ `bus.jpg` å›¾åƒè¿›è¡Œæ£€æµ‹ã€‚æ£€æµ‹ç»“æžœå°†ä¿å­˜åœ¨ `runs/detect/exp` ç›®å½•ä¸‹ã€‚

## ðŸ“‚ æ•°æ®é›†å‡†å¤‡

#### ç›®å½•ç»“æž„

ä¸€ä¸ªç»“æž„è‰¯å¥½çš„æ•°æ®é›†æ˜¯æˆåŠŸçš„ä¸€åŠã€‚è¯·éµå¾ªä»¥ä¸‹ç»“æž„ç»„ç»‡æ‚¨çš„æ–‡ä»¶ï¼š

```
datasets/my_dataset/
â”œâ”€â”€ train/
â”‚   â”œâ”€â”€ images/  # è®­ç»ƒå›¾åƒ (.jpg, .png, etc.)
â”‚   â””â”€â”€ labels/  # YOLO æ ¼å¼çš„æ ‡ç­¾æ–‡ä»¶ (.txt)
â”œâ”€â”€ val/
â”‚   â”œâ”€â”€ images/  # éªŒè¯å›¾åƒ
â”‚   â””â”€â”€ labels/  # éªŒè¯æ ‡ç­¾
â””â”€â”€ test/        # (å¯é€‰) æµ‹è¯•å›¾åƒ
```
> **æç¤º**: æ‚¨å¯ä»¥ä½¿ç”¨ `LabelImg` æˆ– `Roboflow` ç­‰å·¥å…·æ¥æ ‡æ³¨æ•°æ®å¹¶ç”Ÿæˆ YOLO æ ¼å¼çš„æ ‡ç­¾ã€‚

#### åˆ›å»ºæ•°æ®é›†é…ç½®æ–‡ä»¶

åœ¨ `datasets/` ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª `.yaml` æ–‡ä»¶æ¥æè¿°æ‚¨çš„æ•°æ®é›†ï¼Œä¾‹å¦‚ `my_dataset.yaml`:

```yaml
# è®­ç»ƒé›†å’ŒéªŒè¯é›†çš„è·¯å¾„ (ç›¸å¯¹äºŽ yolov5 ç›®å½•)
train: ../datasets/my_dataset/train/images
val: ../datasets/my_dataset/val/images

# ç±»åˆ«æ•°é‡
nc: 3

# ç±»åˆ«åç§° (é¡ºåºå¿…é¡»ä¸Žæ ‡ç­¾æ–‡ä»¶ä¸­çš„ç±»åˆ«ç´¢å¼•å¯¹åº”)
names: ['cone', 'person', 'vehicle']
```

## ðŸ‹ï¸ æ¨¡åž‹è®­ç»ƒ

ä½¿ç”¨æˆ‘ä»¬æä¾›çš„ `scripts/train.py` è„šæœ¬ï¼ˆæˆ–ç›´æŽ¥ä½¿ç”¨ `yolov5/train.py`ï¼‰å¼€å§‹è®­ç»ƒã€‚

#### ä»Žé¢„è®­ç»ƒæƒé‡å¼€å§‹ (æŽ¨è)

```bash
python yolov5/train.py \
  --weights yolov5s.pt \
  --data datasets/my_dataset.yaml \
  --epochs 100 \
  --batch-size 16 \
  --img-size 640 \
  --name my_first_run
```
> **è¯´æ˜Ž**:
> *   `--weights`: `yolov5s.pt` è¡¨ç¤ºä»Žå°åž‹é¢„è®­ç»ƒæ¨¡åž‹å¼€å§‹è®­ç»ƒã€‚æ‚¨ä¹Ÿå¯ä»¥é€‰æ‹© `yolov5m.pt`, `yolov5l.pt` ç­‰ã€‚
> *   `--batch-size`: æ ¹æ®æ‚¨çš„ GPU æ˜¾å­˜å¤§å°è¿›è¡Œè°ƒæ•´ã€‚å¦‚æžœé‡åˆ°æ˜¾å­˜ä¸è¶³ (CUDA out of memory) çš„é”™è¯¯ï¼Œè¯·å‡å°æ­¤å€¼ã€‚
> *   `--name`: æœ¬æ¬¡å®žéªŒçš„åç§°ï¼Œæ‰€æœ‰ç»“æžœå°†ä¿å­˜åœ¨ `runs/train/my_first_run` ç›®å½•ä¸‹ã€‚

#### ç›‘æŽ§è®­ç»ƒè¿‡ç¨‹

YOLOv5 ä¸Ž TensorBoard æ·±åº¦é›†æˆã€‚åœ¨è®­ç»ƒå¼€å§‹åŽï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
tensorboard --logdir runs/train
```
ç„¶åŽåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `http://localhost:6006`ï¼Œå³å¯å®žæ—¶æŸ¥çœ‹æŸå¤±å‡½æ•°ã€mAP ç­‰æŒ‡æ ‡çš„å˜åŒ–ã€‚

## ðŸ“ˆ æ¨¡åž‹è¯„ä¼°

è®­ç»ƒå®ŒæˆåŽï¼Œä½¿ç”¨ `val.py` è„šæœ¬åœ¨éªŒè¯é›†ä¸Šè¯„ä¼°æ¨¡åž‹çš„æœ€ç»ˆæ€§èƒ½ã€‚

```bash
python yolov5/val.py \
  --weights runs/train/my_first_run/weights/best.pt \
  --data datasets/my_dataset.yaml \
  --img-size 640 \
  --task val
```
> **æç¤º**: `best.pt` æ˜¯åœ¨éªŒè¯é›†ä¸Šå–å¾—æœ€ä½³ mAP çš„æ¨¡åž‹æƒé‡ã€‚

#### æ ¸å¿ƒè¯„ä¼°æŒ‡æ ‡

| æŒ‡æ ‡ | æè¿° | å‚è€ƒç›®æ ‡ |
| :--- | :--- | :--- |
| **mAP@0.5** | IoU é˜ˆå€¼ä¸º 0.5 æ—¶çš„å¹³å‡ç²¾åº¦ï¼Œæ˜¯è¡¡é‡æ¨¡åž‹å¥½åçš„ä¸»è¦æ ‡å‡†ã€‚ | > 0.8 |
| **mAP@.5:.95**| åœ¨ IoU é˜ˆå€¼ä»Ž 0.5 åˆ° 0.95 èŒƒå›´å†…ï¼Œä»¥ 0.05 ä¸ºæ­¥é•¿è®¡ç®—çš„ mAP å‡å€¼ã€‚ | > 0.6 |
| **Precision** | ç²¾ç¡®çŽ‡ (æŸ¥å‡†çŽ‡)ï¼Œè¡¨ç¤ºé¢„æµ‹ä¸ºæ­£çš„æ ·æœ¬ä¸­æœ‰å¤šå°‘æ˜¯çœŸæ­£çš„æ­£æ ·æœ¬ã€‚ | > 0.85 |
| **Recall** | å¬å›žçŽ‡ (æŸ¥å…¨çŽ‡)ï¼Œè¡¨ç¤ºæ‰€æœ‰æ­£æ ·æœ¬ä¸­æœ‰å¤šå°‘è¢«æˆåŠŸé¢„æµ‹ã€‚ | > 0.8 |

## ðŸ’¡ æ¨¡åž‹æŽ¨ç†

ä½¿ç”¨æ‚¨è®­ç»ƒå¥½çš„æ¨¡åž‹å¯¹æ–°æ•°æ®è¿›è¡Œé¢„æµ‹ã€‚

#### å›¾åƒæ£€æµ‹

```bash
python yolov5/detect.py \
  --weights runs/train/my_first_run/weights/best.pt \
  --source path/to/your/test_images/ \
  --conf-thres 0.4
```

#### è§†é¢‘æ£€æµ‹

```bash
python yolov5/detect.py \
  --weights runs/train/my_first_run/weights/best.pt \
  --source path/to/your/video.mp4
```

#### å®žæ—¶æ‘„åƒå¤´æ£€æµ‹

```bash
python yolov5/detect.py \
  --weights runs/train/my_first_run/weights/best.pt \
  --source 0  # 0 ä»£è¡¨é»˜è®¤æ‘„åƒå¤´
```

## ðŸš€ æ€§èƒ½ä¼˜åŒ–ä¸Žéƒ¨ç½²

ä¸ºäº†åœ¨ç”Ÿäº§çŽ¯å¢ƒä¸­èŽ·å¾—æœ€ä½³æ€§èƒ½ï¼Œæ‚¨éœ€è¦å¯¹æ¨¡åž‹è¿›è¡Œä¼˜åŒ–å’Œå¯¼å‡ºã€‚

ä½¿ç”¨ `yolov5/export.py` è„šæœ¬å¯ä»¥å°† `.pt` æ¨¡åž‹è½¬æ¢ä¸ºä¸åŒæ ¼å¼ï¼š

```bash
python yolov5/export.py \
  --weights runs/train/my_first_run/weights/best.pt \
  --img-size 640 \
  --include onnx engine # åŒæ—¶å¯¼å‡º ONNX å’Œ TensorRT engine
```

#### ä¼˜åŒ–ç­–ç•¥æ¦‚è§ˆ

1.  **ONNX**: ä¸€ç§å¼€æ”¾çš„ç¥žç»ç½‘ç»œäº¤æ¢æ ¼å¼ï¼Œå…·æœ‰è‰¯å¥½çš„è·¨å¹³å°å…¼å®¹æ€§ã€‚
2.  **TensorRT (æŽ¨è)**: NVIDIA çš„é«˜æ€§èƒ½æ·±åº¦å­¦ä¹ æŽ¨ç†å¼•æ“Žï¼Œå¯ä¸º NVIDIA GPU æä¾›æžè‡´çš„æŽ¨ç†é€Ÿåº¦ã€‚
3.  **INT8 é‡åŒ–**: å°†æ¨¡åž‹æƒé‡ä»Ž FP32ï¼ˆ32ä½æµ®ç‚¹æ•°ï¼‰è½¬æ¢ä¸º INT8ï¼ˆ8ä½æ•´æ•°ï¼‰ï¼Œå¯æ˜¾è‘—å‡å°æ¨¡åž‹ä½“ç§¯å¹¶åŠ é€Ÿè®¡ç®—ï¼Œä½†å¯èƒ½ä¼´æœ‰è½»å¾®çš„ç²¾åº¦æŸå¤±ã€‚

## ðŸ”§ é«˜çº§åŠŸèƒ½

#### è‡ªå®šä¹‰æ¨¡åž‹æž¶æž„

åœ¨ `models/` ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„ `.yaml` æ–‡ä»¶ï¼ˆä¾‹å¦‚ `my_custom_model.yaml`ï¼‰ï¼Œä¿®æ”¹ç½‘ç»œç»“æž„ï¼ˆå¦‚æ·±åº¦ã€å®½åº¦ã€æ¨¡å—ï¼‰ï¼Œç„¶åŽåœ¨è®­ç»ƒæ—¶é€šè¿‡ `--cfg` å‚æ•°æŒ‡å®šã€‚

```bash
python yolov5/train.py --cfg models/my_custom_model.yaml ...
```

#### è¿ç§»å­¦ä¹ ä¸Žå†»ç»“è®­ç»ƒ

å¦‚æžœä½ æƒ³åœ¨ä¸€ä¸ªå·²æœ‰çš„è‡ªå®šä¹‰æ¨¡åž‹ä¸Šç»§ç»­è®­ç»ƒï¼Œå¯ä»¥å†»ç»“éƒ¨åˆ†å±‚çº§çš„æƒé‡ã€‚

```bash
python yolov5/train.py \
  --weights path/to/your/last.pt \
  --data datasets/new_dataset.yaml \
  --epochs 50 \
  --freeze 10  # å†»ç»“éª¨å¹²ç½‘ç»œçš„å‰10å±‚
```

## ðŸ¤ è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿Žä»»ä½•å½¢å¼çš„è´¡çŒ®ï¼å¦‚æžœæ‚¨æœ‰å¥½çš„æƒ³æ³•æˆ–å‘çŽ°äº†é—®é¢˜ï¼Œè¯·éµå¾ªä»¥ä¸‹æµç¨‹ï¼š

1.  **Fork** æœ¬é¡¹ç›®ä»“åº“ã€‚
2.  åˆ›å»ºä¸€ä¸ªæ–°çš„åŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/your-amazing-feature`)ã€‚
3.  æäº¤æ‚¨çš„ä»£ç æ›´æ”¹ (`git commit -m 'Add some amazing feature'`)ã€‚
4.  å°†æ‚¨çš„åˆ†æ”¯æŽ¨é€åˆ° GitHub (`git push origin feature/your-amazing-feature`)ã€‚
5.  åˆ›å»ºä¸€ä¸ª **Pull Request**ã€‚

## ðŸ“œ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäºŽ [MIT è®¸å¯è¯](LICENSE) å‘å¸ƒã€‚

---
 
> **æœ€åŽæ›´æ–°**: 2025å¹´07æœˆ28æ—¥  
> **YOLOv5 ç‰ˆæœ¬**: v7.0 (æˆ–æ›´é«˜)
